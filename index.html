<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extrair Texto do PDF e Converter para DOCX com Cabeçalho</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
    <script type="text/javascript" src="funcoes.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<script>
    window.onload = function(e){ // assim que carrega a pagina
		//adiciona observador para colagem do email
	 	document.getElementById('cCampodeColagem').addEventListener('paste', handlePaste);
        //obs para pdf           
        document.getElementById('convertButton').addEventListener('click', convertePDF);
            
	}

</script>
<h2>Selecione um arquivo PDF para criar um DOCX com cabeçalho</h2>
<label for="pdfInput">Selecione o arquivo PDF:</label>
<input type="file" id="pdfInput"  accept="application/pdf" />
<button id="convertButton">Processa BO</button>


<fieldset id="fieldCola">
    <legend>Inserir EMAIL</legend>
    <p> Selecione e Copie todo o conteúdo do e-mail, cole na caixa de texto abaixo.</p>
    <textarea id="cCampodeColagem" name="tCampodeColagem" rows="1" cols="10" placeholder="Cole o email aqui" onpaste="fProcessaEmail()"></textarea>
    <button id="criaDOCX">Cria DOCX</button>
</fieldset>

<fieldset id="fieldOutput">
    <legend>Output</legend>
    <div id="output"></div>
</fieldset>

<fieldset id="fieldDados">
    <legend>Dados</legend>
    <label for="cPerito">Perito:</label>
    <input type="text" name="tPerito" id="cPerito" size="50" maxlenght="50" value="Leonardo Reis da Silva" placeholder="Perito" /> </br>

    <label for="cProtocolo">Protocolo:</label>
    <input type="text" name="tProtocolo" id="cProtocolo" size="9" maxlenght="9" placeholder="L00000-24" /> </br>

    <label for="cProtSAEP">Protocolo SAEP:</label>
    <input type="text" name="tProtSAEP" id="cProtSAEP" size="9" maxlenght="9" placeholder="0000000/24" /> </br>

    <label for="cREP">REP:</label>
    <input type="text" name="tREP" id="cREP" size="9" maxlenght="9" placeholder="000000/24" /> </br>

    <label for="cBO">Origem:</label>
    <input type="text" name="tBO" id="cBO" size="40" maxlenght="40" placeholder="Boletim" /> </br>

    <label for="cDelegacia">Delegacia:</label>
    <input type="text" name="tDelegacia" id="cDelegacia" size="40" maxlenght="40" placeholder="Delegacia" /> </br>

    <label for="cAutoridade">Autoridade:</label>
    <input type="text" name="tAutoridade" id="cAutoridade" size="80" maxlenght="80" placeholder="Autoridade" /> </br>
</fieldset>

<fieldset id="fieldNatureza">
    <legend>Naturezas:</legend>
    <label>Natureza do Exame: <input type="text" name="tNaturezaExame" id="cNaturezaExame"/></label></br>
    <label>Natureza Criminal: <input type="text" name="tNaturezaCrime" id="cNaturezaCrime"/></label></br>
</fieldset>

<fieldset id="fieldQuesitos">
    <legend><label><input type="checkbox" checked="true" name="tQuesitos" id="cQuesitos"
    onclick="document.getElementById('fieldQuesitos').disabled = !document.getElementById('cQuesitos').checked"/>
    Quesitos</label></legend>       
        <textarea id="taQuesitos" name="ctaQuesitos" rows="4" cols="50">Quesitos de praxe.</textarea>
</fieldset>

<fieldset id="fieldHistorico">
    <legend><label><input type="checkbox" checked="true" name="tHistorico" id="cHistorico"
    onclick="document.getElementById('fieldHistorico').disabled = !document.getElementById('cHistorico').checked"/>
    Histórico</label></legend>
        <textarea id="taHistorico" name="ctaHistorico" rows="4" cols="50">Histórico.</textarea>
</fieldset>

<fieldset id="fieldPreliminares">
    <legend>Preliminares:</legend>
    <p id="pDataFatos">
        <label for="cDataFatos">Data dos Fatos:</label>
        <input type="date" name="tDataFatos" id="cDataFatos"/></br>

        <label for="cHoraFatos">Hora dos Fatos:</label>
        <input type="time" name="tHoraFatos" id="cHoraFatos"/>
    </p>
    <p id="pDataAciona">
        <label for="cDataAciona">Data do Acionamento:</label>
        <input type="date" name="tDataAciona" id="cDataAciona"/></br>
        <label for="cHoraAciona">Hora do Acionamento:</label>
        <input type="time" name="tHoraAciona" id="cHoraAciona"/></br>
        <button type="button" onclick="transfereData('cDataAciona','cHoraAciona')"/>HORA ATUAL</button>
    </p>
    <p id="pDataExames">
        <label for="cDataExame">Data do Exame:</label>
        <input type="date" name="tDataExame" id="cDataExame"/></br>
        <label for="cHoraExame">Hora do Exame:</label>
        <input type="time" name="tHoraExame" id="cHoraExame"/></br>
        <button type="button" onclick="transfereData('cDataExame','cHoraExame')"/>HORA ATUAL</button>
    </p>
    

    <p>
        <label for="cRua">Logradouro:</label>
        <input type="text" name="tRua" id="cRua" size="50" maxlenght="100" placeholder="Rua" />
    </p>
    <p>
        <label><input type="radio" name="tCidade" value="Americana" id="cAmericana" checked/>Americana</label></br>
        <label><input type="radio" name="tCidade" value="Santa Bárbara d'Oeste" id="cSantaBarb" />Santa Bárbara d'Oeste</label></br>
        <label><input type="radio" name="tCidade" value="Nova Odessa" id="cNovaOdessa" />Nova Odessa</label></br>
        <label><input type="radio" name="tCidade" value="Sumaré" id="cSumare"/>Sumaré</label></br>
        <label><input type="radio" name="tCidade" value="Hortolândia" id="cHortolandia" />Hortolândia</label></br>
        <label><input type="radio" name="tCidade" value="Monte Mor" id="cMonteMor" />Monte Mor</label></br>
        <label><input type="radio" name="tCidade" value="Artur Nogueira" id="cArturNogueira" />Artur Nogueira</label></br>
        <label><input type="radio" name="tCidade" value="Cosmópolis" id="cCosmopolis" />Cosmópolis</label></br>
        <label><input type="radio" name="tCidade" value="Engenheiro Coelho" id="cEngenheiroCoelho" />Engenheiro Coelho</label>
    </p>

    <p>

        <label id="cLatitute">Latitude:</label>
        <label id="cLongitude">; Longitude:</label></br>
        <button type="button" onclick="getLocation()">PEGAR GEOLOCALIZAÇÃO</button>
    </p>
    <p id="preservacaoInformada"><input type="checkbox" name="tUsarPreserInformada" id="usarPreserInformada" hidden="true" /></p>

    <!-- POLICIAL MILITAR 1 -->
    <p><label><input type="checkbox" name="tFlagPM1" id="cFlagPM1"
        onclick="dEsconde('cFlagPM1','fieldsetPM1')"/>
        Policial Militar 1:</label></p>
    <fieldset id="fieldsetPM1">
        <label>Nome:<input type="text" name="tNomePM1" id="cNomePM1" size="15" maxlength="20" placeholder="Nome"/></label>
        <label>RE:<input type="text" name="tREPM1" id="cREPM1" size="10" maxlength="15" placeholder="RE"/></label>
        <label>VTR:<input type="text" name="tVTRPM" id="cVTRPM" size="8" maxlength="15" placeholder="VTR"/></label>
    </fieldset>

    <!--POLICIAL MILITAR 2-->
    <p><label><input type="checkbox" name="tFlagPM2" id="cFlagPM2"
        onclick="dEsconde('cFlagPM2','fieldsetPM2')"/>
        Policial Militar 2:</label></p>
    <fieldset id="fieldsetPM2">
        <label>Nome:<input type="text" name="tNomePM2" id="cNomePM2" size="15" maxlength="20" placeholder="Nome"/></label>
        <label>RE:<input type="text" name="tREPM2" id="cREPM2" size="10" maxlength="15" placeholder="RE"/></label>
    </fieldset>

    <!--POLICIAL CIVIL 1-->
    <p><label><input type="checkbox" name="tFlagPC1" id="cFlagPC1"
        onclick="dEsconde('cFlagPC1','fieldsetPC1')"/>
        Policial Civil 1:</label></p>
    <fieldset id="fieldsetPC1">
        <label>Nome:<input type="text" name="tNomePC1" id="cNomePC1" size="15" maxlength="20" placeholder="Nome"/></label>
        <label>RG:<input type="text" name="tRGPC1" id="cRGPC1" size="10" maxlength="15" placeholder="RG"/></label>
        <label>VTR:<input type="text" name="tVTRPC" id="cVTRPC" size="8" maxlength="15" placeholder="VTR"/></label>
    </fieldset>

    <!--POLICIAL CIVIL 2-->
    <p><label><input type="checkbox" name="tFlagPC2" id="cFlagPC2"
        onclick="dEsconde('cFlagPC2','fieldsetPC2')"/>
        Policial Civil 2:</label></p>
    <fieldset id="fieldsetPC2">
        <label>Nome:<input type="text" name="tNomePC2" id="cNomePC2" size="15" maxlength="20" placeholder="Nome"/></label>
        <label>RG:<input type="text" name="tRGPC2" id="cRGPC2" size="10" maxlength="15" placeholder="RG"/></label>
    </fieldset>

    <!-- GUARDA MUNICIPAL 1-->
    <p><label><input type="checkbox" name="tFlagGM1" id="cFlagGM1"
        onclick="dEsconde('cFlagGM1','fieldsetGM1')"/>
        Guarda Municipal 1:</label></p>
    <fieldset id="fieldsetGM1">
        <label>Nome:<input type="text" name="tNomeGM1" id="cNomeGM1" size="15" maxlength="20" placeholder="Nome"/></label>
        <label>RG:<input type="text" name="tRGGM1" id="cRGGM1" size="10" maxlength="15" placeholder="RG"/></label>
        <label>VTR:<input type="text" name="tVTRGM" id="cVTRGM" size="8" maxlength="15" placeholder="VTR"/></label>
    </fieldset>

    <!-- GUARDA MUNICIPAL 2-->
    <p><label><input type="checkbox" name="tFlagGM2" id="cFlagGM2"
        onclick="dEsconde('cFlagGM2','fieldsetGM2')"/>
        Guarda Municipal 2:</label></p>
    <fieldset id="fieldsetGM2">
        <label>Nome:<input type="text" name="tNomeGM2" id="cNomeGM2" size="15" maxlength="20" placeholder="Nome"/></label>
        <label>RG:<input type="text" name="tRGGM2" id="cRGGM2" size="10" maxlength="15" placeholder="RG"/></label>
    </fieldset>

    <fieldset id="fieldsetVitima" disabled="true">
        <legend><label><input type="checkbox" name="tFlagVitima" id="cFlagVitima"
        onclick="document.getElementById('fieldsetVitima').disabled = !document.getElementById('cFlagVitima').checked"/>
        Vítima/Representante:</label></legend>
        <label>Nome:<input type="text" name="tNomeVit" id="cNomeVit" size="32" maxlength="32" placeholder="Nome"/></label>
        <label>RG:<input type="text" name="tRGVit" id="cRGVit" size="12" maxlength="15" placeholder="RG"/></label>
    </fieldset>
</fieldset>

<script>
    
    
    //botão para criar o DOCX
    document.getElementById('criaDOCX').addEventListener('click', function() {
        var aaa = document.getElementById('output').textContent;
        criaDOCX(aaa,"textinho");
    });

</script>

</body>
</html>