<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extrair Texto do PDF e Converter para DOCX com Cabeçalho</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
    <script type="text/javascript" src="funcoes.js"></script>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
<script>
    window.onload = function(e){ // assim que carrega a pagina
		//adiciona observador para colagem do email
	 	document.getElementById('cCampodeColagem').addEventListener('paste', handlePaste);
        //obs para pdf           
        document.getElementById('convertButton').addEventListener('click', convertePDF);           
            
	}

</script>
<h2>Selecione um arquivo PDF para criar um DOCX com cabeçalho</h2>
<input type="file" id="pdfInput" accept="application/pdf" />
<button id="convertButton">Processa BO</button>


<fieldset id="fieldCola">
    <legend>Inserir EMAIL</legend>
    <p> Selecione e Copie todo o conteúdo do e-mail, cole na caixa de texto abaixo.</p>
    <textarea id="cCampodeColagem" name="tCampodeColagem" rows="1" cols="10" placeholder="Cole o email aqui" onpaste="fProcessaEmail()"></textarea>
    <button id="criaDOCX">Cria DOCX</button>
</fieldset>

<fieldset id="fieldOutput">
    <legend>Output</legend>
    <div id="output"></div>
</fieldset>

<script>
    //botão para criar o DOCX
    document.getElementById('criaDOCX').addEventListener('click', function() {
        var aaa = document.getElementById('output').textContent;
        criaDOCX(aaa,"textinho");
    });

</script>

</body>
</html>